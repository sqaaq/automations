// ==UserScript==
// @name         Edit AD user .PS
// @namespace    https://sqaaq.github.io/automations
// @version      1.10
// @description  Кнопка появляется только при наличии "Выход нового сотрудника" в заголовке + FullAutoAnswer + Passw gen
// @author       Egor & AI
// @match        https://*/front/ticket.form.php?*
// @downloadURL  https://sqaaq.github.com/automations/userscripts/editADuser.user.js
// @updateURL    https://sqaaq.github.com/automations/userscripts/editADuser.meta.js
// @grant        none
// ==/UserScript==

(function(_0x494a27,_0x37bb2b){const _0x9df04a=_0x109b,_0x26ad7d=_0x494a27();while(!![]){try{const _0xbbe71f=-parseInt(_0x9df04a(0x19f))/0x1*(parseInt(_0x9df04a(0x14e))/0x2)+parseInt(_0x9df04a(0x156))/0x3+parseInt(_0x9df04a(0x16c))/0x4+-parseInt(_0x9df04a(0x19d))/0x5+parseInt(_0x9df04a(0x184))/0x6+-parseInt(_0x9df04a(0x1b1))/0x7+parseInt(_0x9df04a(0x147))/0x8*(parseInt(_0x9df04a(0x168))/0x9);if(_0xbbe71f===_0x37bb2b)break;else _0x26ad7d['push'](_0x26ad7d['shift']());}catch(_0x157e77){_0x26ad7d['push'](_0x26ad7d['shift']());}}}(_0x31e6,0x48566),(function(){'use strict';const _0x6b8065=_0x109b;function _0x4ac228(_0x2076c7){const _0x34ab88=_0x109b;let _0x1a3695=_0x2076c7[_0x34ab88(0x15d)](/\D/g,'');if(_0x1a3695[_0x34ab88(0x1a1)]('8')&&_0x1a3695[_0x34ab88(0x15e)]===0xb)_0x1a3695='7'+_0x1a3695[_0x34ab88(0x1ae)](0x1);else{if(_0x1a3695[_0x34ab88(0x1a1)]('9')&&_0x1a3695[_0x34ab88(0x15e)]===0xa)_0x1a3695='7'+_0x1a3695;else{if(_0x1a3695[_0x34ab88(0x1a1)]('+7')){_0x1a3695=_0x1a3695[_0x34ab88(0x1ae)](0x2);if(_0x1a3695[_0x34ab88(0x15e)]===0xa)_0x1a3695='7'+_0x1a3695;}}}if(_0x1a3695[_0x34ab88(0x15e)]===0xb&&_0x1a3695[_0x34ab88(0x1a1)]('7'))return _0x34ab88(0x148)+_0x1a3695[_0x34ab88(0x1ae)](0x1,0x4)+'\x20'+_0x1a3695[_0x34ab88(0x1ae)](0x4,0x7)+'\x20'+_0x1a3695['slice'](0x7,0x9)+'\x20'+_0x1a3695[_0x34ab88(0x1ae)](0x9,0xb);return _0x2076c7;}function _0x41d39e(_0x1ff6a1=0x8){const _0x5971ed=_0x109b,_0x1db168=_0x5971ed(0x154),_0x37f16c='abcdefghjkmnpqrstuvwxyz',_0x472bff=_0x5971ed(0x173),_0xa574f6=_0x1db168+_0x37f16c+_0x472bff;let _0x4b4c5e=[_0x1db168[Math[_0x5971ed(0x193)](Math[_0x5971ed(0x167)]()*_0x1db168[_0x5971ed(0x15e)])],_0x37f16c[Math[_0x5971ed(0x193)](Math[_0x5971ed(0x167)]()*_0x37f16c[_0x5971ed(0x15e)])],_0x472bff[Math[_0x5971ed(0x193)](Math[_0x5971ed(0x167)]()*_0x472bff[_0x5971ed(0x15e)])]];for(let _0x178538=0x3;_0x178538<_0x1ff6a1;_0x178538++){_0x4b4c5e[_0x5971ed(0x166)](_0xa574f6[Math[_0x5971ed(0x193)](Math[_0x5971ed(0x167)]()*_0xa574f6['length'])]);}for(let _0x39dc70=_0x4b4c5e['length']-0x1;_0x39dc70>0x0;_0x39dc70--){const _0x58c656=Math[_0x5971ed(0x193)](Math['random']()*(_0x39dc70+0x1));[_0x4b4c5e[_0x39dc70],_0x4b4c5e[_0x58c656]]=[_0x4b4c5e[_0x58c656],_0x4b4c5e[_0x39dc70]];}return _0x4b4c5e[_0x5971ed(0x1aa)]('');}const _0x54fa58=_0x41d39e();function _0x17166b(_0x5a8e4a){const _0x4ac259=_0x109b;let _0x30b399=_0x5a8e4a[_0x4ac259(0x15a)]()[_0x4ac259(0x16d)](/\s+/);if(_0x30b399['length']>=0x2)return _0x30b399[0x1]+'\x20'+_0x30b399[0x0];return _0x5a8e4a;}function _0x5a5ec8(_0x4da54c){const _0x510721=_0x109b;if(!_0x4da54c||!_0x4da54c[_0x510721(0x15e)])return'';return _0x4da54c[0x0][_0x510721(0x1a0)]()+_0x4da54c[_0x510721(0x1ae)](0x1)[_0x510721(0x172)]();}function _0x473bea(_0x134fa1,_0x4f838d){const _0x138a26=_0x109b;let _0x3c2e41=_0x134fa1[_0x138a26(0x15a)]()[_0x138a26(0x16d)](/\s+/);if(_0x3c2e41[_0x138a26(0x15e)]<0x2)return'';let _0x5b0290=_0x5a5ec8(_0x3c2e41[0x1]),_0x2e58d5=_0x5a5ec8(_0x3c2e41[0x0]);return _0x5b0290+'.'+_0x2e58d5+'@'+_0x4f838d;}function _0x5d351d(_0x256680){const _0x50f05a=_0x109b;let _0x5f211d={},_0x39d759=_0x256680[_0x50f05a(0x1ad)](/учетная запись\s+(\w+)/i),_0x3d5e07=_0x256680['match'](/Телефон:\s*(\d+)/i),_0x4b0e81=_0x256680['match'](/Дата рождения:\s*([\d\.]+)/i),_0x13b531=_0x256680[_0x50f05a(0x1ad)](/Руководитель:\s*([\u0400-\u04FF\s\-]+)/i),_0x5cc875=_0x256680[_0x50f05a(0x1ad)](/Почтовый домен:\s*([\w\.\-]+)/i),_0x2a6b4e=_0x256680['match'](/Фамилия\/имя:\s*([A-Za-zА-Яа-яЁё\s\-]+)/i);if(_0x39d759)_0x5f211d['account']=_0x39d759[0x1];if(_0x3d5e07)_0x5f211d['phone']=_0x4ac228(_0x3d5e07[0x1]);if(_0x4b0e81)_0x5f211d[_0x50f05a(0x194)]=_0x4b0e81[0x1];if(_0x13b531)_0x5f211d[_0x50f05a(0x144)]=_0x13b531[0x1][_0x50f05a(0x15a)]();if(_0x5cc875){const _0x41468d=_0x5cc875[0x1][_0x50f05a(0x172)](),_0x644b1={'pointsgroup.ru':'Points','arenamb.ru':_0x50f05a(0x17c),'advgroup.ru':_0x50f05a(0x18e),'advbenchmark.ru':'ADV\x20Benchmark','advdigital.ru':_0x50f05a(0x174),'advperformance.ru':_0x50f05a(0x1a5),'initiativemedia.ru':_0x50f05a(0x150),'otc24.ru':_0x50f05a(0x163),'umww.ru':'UM','advecomm.ru':_0x50f05a(0x18c),'advelop.ru':_0x50f05a(0x165)};_0x5f211d[_0x50f05a(0x192)]=_0x644b1[_0x41468d]||'',_0x5f211d[_0x50f05a(0x1a3)]=_0x41468d;}return _0x2a6b4e&&_0x5cc875&&(_0x5f211d[_0x50f05a(0x1ab)]=_0x2a6b4e[0x1][_0x50f05a(0x15a)](),_0x5f211d['useremail']=_0x473bea(_0x5f211d[_0x50f05a(0x1ab)],_0x5f211d[_0x50f05a(0x1a3)])),_0x5f211d;}function _0x19970a(_0x1f1069){const _0xd5e1b9=_0x109b;if(!_0x1f1069['account']||!_0x1f1069['phone']||!_0x1f1069[_0xd5e1b9(0x194)]||!_0x1f1069[_0xd5e1b9(0x144)])return _0xd5e1b9(0x14c);let _0x1fbdee=_0x17166b(_0x1f1069[_0xd5e1b9(0x144)]);return(_0xd5e1b9(0x182)+_0x1fbdee+'*\x22\x20}\x20-Properties\x20SamAccountName,\x20DistinguishedName\x0a$primaryManager\x20=\x20$managers\x20|\x20Where-Object\x20{\x20$_.SamAccountName\x20-notmatch\x20\x22^[A-Z]{3}\x5c.\x22\x20}\x20|\x20Select-Object\x20-First\x201\x0a\x0aif\x20($primaryManager\x20-ne\x20$null)\x20{\x0a\x20\x20\x20\x20$managerDN\x20=\x20$primaryManager.DistinguishedName\x0a\x20\x20\x20\x20Set-ADUser\x20-Identity\x20\x27'+_0x1f1069['account']+_0xd5e1b9(0x14d)+_0x1f1069[_0xd5e1b9(0x18d)]+_0xd5e1b9(0x17f)+_0x1f1069[_0xd5e1b9(0x194)]+_0xd5e1b9(0x16f)+_0x1f1069[_0xd5e1b9(0x192)]+'\x27}\x20-Manager\x20$managerDN\x0a}\x20else\x20{\x0a\x20\x20\x20\x20Set-ADUser\x20-Identity\x20\x27'+_0x1f1069[_0xd5e1b9(0x15c)]+_0xd5e1b9(0x14d)+_0x1f1069[_0xd5e1b9(0x18d)]+_0xd5e1b9(0x17f)+_0x1f1069[_0xd5e1b9(0x194)]+_0xd5e1b9(0x16f)+_0x1f1069[_0xd5e1b9(0x192)]+_0xd5e1b9(0x189)+_0x1f1069[_0xd5e1b9(0x15c)]+_0xd5e1b9(0x158)+_0x54fa58+'\x22\x20-AsPlainText\x20-Force)\x20-Reset\x0aEnable-ADAccount\x20-Identity\x20\x27'+_0x1f1069[_0xd5e1b9(0x15c)]+_0xd5e1b9(0x196)+_0x1f1069[_0xd5e1b9(0x15c)]+'\x27\x0a')[_0xd5e1b9(0x15a)]();}function _0x30e6ab(){return new Promise(_0x43538b=>{const _0x564b61=()=>{const _0x22747e=_0x109b,_0x138704=document['querySelector'](_0x22747e(0x19b));if(_0x138704)_0x43538b(_0x138704);else setTimeout(_0x564b61,0x1f4);};_0x564b61();});}function _0x22f36e(){const _0x3698ba=_0x109b,_0x397639=document[_0x3698ba(0x16b)](_0x3698ba(0x180));if(!_0x397639)return;const _0x46ead0=_0x397639[_0x3698ba(0x16b)](_0x3698ba(0x19e));if(!_0x46ead0||!/выход нового сотрудника/i[_0x3698ba(0x1a8)](_0x46ead0['textContent']))return;const _0x55fef6=_0x397639[_0x3698ba(0x16b)]('.rich_text_container');if(!_0x55fef6||_0x397639[_0x3698ba(0x16b)](_0x3698ba(0x1ac)))return;const _0x4e5405=_0x397639[_0x3698ba(0x197)],_0x5e984d=_0x5d351d(_0x4e5405),_0x3a83f4=document[_0x3698ba(0x195)](_0x3698ba(0x170));_0x3a83f4[_0x3698ba(0x178)][_0x3698ba(0x17d)]('edit-ps-container'),_0x3a83f4[_0x3698ba(0x183)]['display']=_0x3698ba(0x157),_0x3a83f4[_0x3698ba(0x183)]['alignItems']=_0x3698ba(0x186),_0x3a83f4['style']['gap']=_0x3698ba(0x18b),_0x3a83f4[_0x3698ba(0x183)]['marginTop']=_0x3698ba(0x1b0);const _0x583466=document[_0x3698ba(0x195)](_0x3698ba(0x170));_0x583466[_0x3698ba(0x183)][_0x3698ba(0x159)]=_0x3698ba(0x157),_0x583466[_0x3698ba(0x183)][_0x3698ba(0x19a)]=_0x3698ba(0x1a2),_0x583466[_0x3698ba(0x183)][_0x3698ba(0x17a)]='flex-start',_0x583466['style'][_0x3698ba(0x185)]=_0x3698ba(0x162);const _0x1ec024=document[_0x3698ba(0x195)](_0x3698ba(0x1a7));_0x1ec024[_0x3698ba(0x18a)]='EditADuser.PS',_0x1ec024[_0x3698ba(0x183)][_0x3698ba(0x1a4)]=_0x3698ba(0x19c),_0x1ec024[_0x3698ba(0x183)]['width']=_0x3698ba(0x155),_0x583466[_0x3698ba(0x14b)](_0x1ec024);const _0x450734=document[_0x3698ba(0x195)](_0x3698ba(0x170));_0x450734['style'][_0x3698ba(0x157)]='1\x201\x20auto';const _0x3cdad0=document[_0x3698ba(0x195)](_0x3698ba(0x187));_0x3cdad0[_0x3698ba(0x183)]['background']='#f0f0f0',_0x3cdad0[_0x3698ba(0x183)][_0x3698ba(0x145)]='1px\x20solid\x20#ccc',_0x3cdad0[_0x3698ba(0x183)][_0x3698ba(0x181)]=_0x3698ba(0x1b0),_0x3cdad0['style'][_0x3698ba(0x153)]='pre-wrap',_0x3cdad0[_0x3698ba(0x183)][_0x3698ba(0x199)]='0',_0x3cdad0['style']['minWidth']=_0x3698ba(0x176),_0x3cdad0[_0x3698ba(0x183)][_0x3698ba(0x17b)]=_0x3698ba(0x164),_0x3cdad0[_0x3698ba(0x183)][_0x3698ba(0x159)]='none',_0x3cdad0[_0x3698ba(0x183)]['maxHeight']=_0x3698ba(0x1a9),_0x3cdad0[_0x3698ba(0x183)]['overflowY']='auto',_0x450734[_0x3698ba(0x14b)](_0x3cdad0);const _0x225fc2=document['createElement']('div');_0x225fc2[_0x3698ba(0x183)][_0x3698ba(0x159)]=_0x3698ba(0x157),_0x225fc2['style'][_0x3698ba(0x19a)]=_0x3698ba(0x1a2),_0x225fc2[_0x3698ba(0x183)][_0x3698ba(0x17a)]=_0x3698ba(0x186),_0x225fc2[_0x3698ba(0x183)]['alignItems']=_0x3698ba(0x162),_0x225fc2[_0x3698ba(0x183)][_0x3698ba(0x1a6)]=_0x3698ba(0x1b0);const _0x1e0e6d=document[_0x3698ba(0x195)](_0x3698ba(0x1a7));_0x1e0e6d[_0x3698ba(0x18a)]=_0x3698ba(0x16e),_0x1e0e6d[_0x3698ba(0x183)][_0x3698ba(0x1a4)]=_0x3698ba(0x19c),_0x1e0e6d['style'][_0x3698ba(0x188)]=_0x3698ba(0x160),_0x225fc2[_0x3698ba(0x14b)](_0x1e0e6d);const _0x573b18=document[_0x3698ba(0x195)](_0x3698ba(0x1a7));_0x573b18['textContent']=_0x3698ba(0x1af),_0x573b18[_0x3698ba(0x183)][_0x3698ba(0x1a4)]=_0x3698ba(0x19c),_0x573b18['style'][_0x3698ba(0x159)]=_0x3698ba(0x151),_0x573b18[_0x3698ba(0x183)][_0x3698ba(0x188)]=_0x3698ba(0x160),_0x225fc2['appendChild'](_0x573b18),_0x1ec024[_0x3698ba(0x143)](_0x3698ba(0x15f),()=>{const _0x4ae3ad=_0x3698ba;if(_0x3cdad0[_0x4ae3ad(0x183)][_0x4ae3ad(0x159)]===_0x4ae3ad(0x14f))_0x3cdad0[_0x4ae3ad(0x183)]['display']=_0x4ae3ad(0x151),_0x573b18[_0x4ae3ad(0x183)][_0x4ae3ad(0x159)]=_0x4ae3ad(0x151);else{const _0x1e02d5=_0x19970a(_0x5e984d);_0x3cdad0[_0x4ae3ad(0x18a)]=_0x1e02d5,_0x3cdad0['style'][_0x4ae3ad(0x159)]=_0x4ae3ad(0x14f),_0x573b18[_0x4ae3ad(0x183)][_0x4ae3ad(0x159)]=_0x4ae3ad(0x152);}}),_0x573b18[_0x3698ba(0x143)](_0x3698ba(0x15f),()=>{const _0x2f9350=_0x3698ba;_0x3cdad0[_0x2f9350(0x18a)][_0x2f9350(0x15a)]()&&navigator[_0x2f9350(0x190)][_0x2f9350(0x179)](_0x3cdad0[_0x2f9350(0x18a)])[_0x2f9350(0x18f)](()=>{const _0x391678=_0x2f9350;_0x573b18[_0x391678(0x18a)]=_0x391678(0x16a),setTimeout(()=>{_0x573b18['textContent']='Copy';},0x7d0);});}),_0x1e0e6d[_0x3698ba(0x143)](_0x3698ba(0x15f),async()=>{const _0x29809b=_0x3698ba,_0x4068a7=document[_0x29809b(0x16b)]('button.answer-action');if(_0x4068a7)_0x4068a7[_0x29809b(0x15f)]();else{alert(_0x29809b(0x198));return;}const _0x2dba53=await _0x30e6ab();if(_0x2dba53){const _0x4b78c7=_0x2dba53[_0x29809b(0x177)]||_0x2dba53[_0x29809b(0x161)][_0x29809b(0x191)];_0x4b78c7[_0x29809b(0x171)]['innerHTML']='\x0aДобрый\x20день!<br>\x0aУчетная\x20запись\x20готова.<br>\x0aПочта:\x20'+_0x5e984d[_0x29809b(0x146)]+_0x29809b(0x15b)+_0x5e984d[_0x29809b(0x15c)]+_0x29809b(0x17e)+_0x54fa58+_0x29809b(0x169)+_0x5e984d[_0x29809b(0x15c)]+'<br>\x0aПароль:\x20'+_0x54fa58;}else alert(_0x29809b(0x14a));}),_0x3a83f4['appendChild'](_0x583466),_0x3a83f4[_0x3698ba(0x14b)](_0x450734),_0x3a83f4[_0x3698ba(0x14b)](_0x225fc2),_0x55fef6['insertAdjacentElement'](_0x3698ba(0x175),_0x3a83f4);}window[_0x6b8065(0x143)](_0x6b8065(0x149),()=>{setTimeout(_0x22f36e,0x3e8);});}()));function _0x109b(_0x3e5655,_0x11afee){const _0x31e681=_0x31e6();return _0x109b=function(_0x109ba0,_0x512b59){_0x109ba0=_0x109ba0-0x143;let _0x4f06cf=_0x31e681[_0x109ba0];return _0x4f06cf;},_0x109b(_0x3e5655,_0x11afee);}function _0x31e6(){const _0x4a1709=['div','body','toLowerCase','23456789','ADV\x20Digital','afterend','300px','contentDocument','classList','writeText','justifyContent','maxWidth','Arena','add','@advmoscow.ru<br>\x0aПароль:\x20','\x27;\x20extensionAttribute1=\x27','.mt-2.timeline-content.left.card','padding','\x0a$managers\x20=\x20Get-ADUser\x20-Filter\x20{\x20info\x20-like\x20\x22*','style','1406946LiMbQU','alignItems','flex-start','pre','width','\x27}\x0a}\x0a\x0aSet-ADAccountPassword\x20-Identity\x20\x27','textContent','25px','ADV\x20eCommerce','phone','ADV','then','clipboard','document','company','floor','birth_date','createElement','\x27\x0aAdd-ADGroupMember\x20-Identity\x20\x22SG-G-AnyconnectUsers\x22\x20-Members\x20\x27','innerText','Кнопка\x20\x22Ответ\x22\x20не\x20найдена','margin','flexDirection','iframe[id^=\x22content_\x22]','pointer','2032805zZQGOJ','.card-title.card-header.mx-n3.mt-n3','81392QjDahA','toUpperCase','startsWith','column','domain','cursor','ADV\x20Performance','gap','button','test','200px','join','fio','.edit-ps-container','match','slice','Copy.PS','10px','301973TgjfCi','addEventListener','manager','border','useremail','8AudSxL','+7\x20','load','Не\x20найдено\x20поле\x20ввода','appendChild','Ошибка:\x20Не\x20найдены\x20необходимые\x20поля\x20в\x20заявке.','\x27\x20-Replace\x20@{mobile=\x27','6xmCViw','block','Initiative','none','inline-block','whiteSpace','ABCDEFGHJKLMNPQRSTUVWXYZ','120px','233031zYMjiQ','flex','\x27\x20-NewPassword\x20(ConvertTo-SecureString\x20\x22','display','trim','<br><br>\x0aTeams:\x20','account','replace','length','click','100px','contentWindow','center','OTC','600px','ADVelop','push','random','3850569aUKwph','<br><br>\x0aНоутбук\x20|\x20rds.advmoscow.ru\x20|\x20Удаленный\x20рабочий\x20стол<br>\x0aЛогин:\x20advmoscow\x5c','Copied!','querySelector','1000644OhjVQe','split','AutoAnswer','\x27;\x20company=\x27'];_0x31e6=function(){return _0x4a1709;};return _0x31e6();}
